/**
 * Script to generate all landing page images from prompts
 * Run with: node scripts/generate-landing-images.mjs
 * 
 * Requires: NEXT_PUBLIC_GEMINI_API_KEY or GEMINI_API_KEY in environment
 */

import { GoogleGenAI } from "@google/genai";
import { writeFileSync, mkdirSync } from 'fs';
import { join } from 'path';

const API_KEY = process.env.NEXT_PUBLIC_GEMINI_API_KEY || 
                process.env.GEMINI_API_KEY || 
                process.env.API_KEY;

if (!API_KEY) {
  console.error('Error: No API key found. Set NEXT_PUBLIC_GEMINI_API_KEY or GEMINI_API_KEY');
  process.exit(1);
}

const ai = new GoogleGenAI({ apiKey: API_KEY });
const outputDir = join(process.cwd(), 'public', 'images', 'landing');

// Ensure directory exists
mkdirSync(outputDir, { recursive: true });

// All prompts from landing page components
const imagePrompts = [
  // Hero
  { name: 'hero-dashboard', prompt: 'dashboard ui of usdrop platform dark mode, showing neon blue revenue charts climbing, map of usa orders, sidebar with ai tools, clean modern interface, high resolution' },
  
  // Steps Overview
  { name: 'steps-discovery', prompt: 'dashboard showing winning product cards with fire icons and profit margins, clean white ui' },
  { name: 'steps-create', prompt: 'ai image generator interface showing a generated fashion model wearing a product, creative studio ui' },
  { name: 'steps-scale', prompt: 'growth chart showing revenue scaling up, green arrows, minimal business analytics' },
  
  // Product Swipe
  { name: 'product-moon-lamp', prompt: 'levitating moon lamp floating above wood base, dark room, glowing warm light, product photography' },
  { name: 'product-neck-fan', prompt: 'portable neck fan worn by model, summer vibes, cyan color, lifestyle photography' },
  { name: 'product-galaxy-projector', prompt: 'galaxy projector in bedroom, nebula clouds on ceiling, purple and blue lighting' },
  
  // Features Bento
  { name: 'features-product-grid', prompt: 'grid of ecommerce products, smartwatches, beauty, gadgets, clean minimal aesthetic, white background' },
  { name: 'features-ai-model', prompt: 'futuristic fashion model generated by AI, wearing neon streetwear, cinematic lighting, vertical portrait' },
  { name: 'features-academy', prompt: '3d abstract education icons, book, lightbulb, floating, dark background' },
  
  // AI Studio
  { name: 'ai-image-studio', prompt: 'high end perfume bottle on water surface with ripples, luxury product photography, dramatic lighting, 8k' },
  { name: 'ai-model-studio', prompt: 'portrait of diverse fashion models wearing branded hoodies, urban street style, bright daylight, commercial fashion' },
  { name: 'ai-ad-studio', prompt: 'collage of colorful social media icons and marketing assets, 3d render style, vibrant' },
  { name: 'ai-campaign-studio', prompt: 'marketing strategy dashboard on a futuristic glass tablet, showing campaign growth' },
  
  // Automation Flow
  { name: 'automation-order', prompt: 'icon of a product being selected on a screen, minimalist vector' },
  { name: 'automation-pack', prompt: 'icon of a robot arm packing a box, minimalist vector' },
  { name: 'automation-customer', prompt: 'icon of a happy customer holding a package, minimalist vector' },
  { name: 'automation-blender', prompt: 'product photo of a smart portable blender' },
  
  // Deep Dive Features
  { name: 'deepdive-store-analytics', prompt: 'comprehensive store analytics dashboard, list of competitor stores with revenue graphs, traffic sources pie charts, clean saas ui, blue and grey theme' },
  { name: 'deepdive-galaxy-projector', prompt: 'product photography of galaxy projector night light, dark room, stars projection' },
  { name: 'deepdive-shiba-toy', prompt: 'product photography of shiba inu plush toy, soft lighting, white background' },
  
  // Advanced Tools Grid
  { name: 'tools-competitor-research', prompt: 'data list of competitor ecommerce stores, showing traffic stats, social links, and top selling items, clean interface' },
  { name: 'tools-saturation', prompt: 'gauge chart showing market saturation level, green to red gradient, analytics visualization' },
  { name: 'tools-market-finder', prompt: 'world map heatmap showing sales density in different countries, data overlay, clean ui' },
  { name: 'tools-seasonal', prompt: 'line chart showing seasonal sales spikes over a year timeline, trend analysis graph' },
  { name: 'tools-profit-calc', prompt: 'calculator interface with input fields for product cost, shipping, ad spend, and profit breakdown chart' },
  { name: 'tools-emerging-stores', prompt: 'grid of new shopify store logos and growth percentages, trending upward icons' },
  
  // Product Showcase
  { name: 'product-nursery-monitor', prompt: 'high tech baby monitor with camera and app interface, nursery setting, soft lighting, product photography, white background' },
  { name: 'product-kbeauty', prompt: 'luxury korean skincare set bottles 10 step routine, pastel colors, water splash, podium, beauty product photography' },
  { name: 'product-headphones', prompt: 'sleek silver wireless noise cancelling headphones, floating, premium tech lighting, white background studio shot, 4k' },
  { name: 'product-maxi-dress', prompt: 'boho style summer maxi dress floral print, hanging on rack, sunlight flare, bright lifestyle fashion photography' },
  
  // Supplier Network
  { name: 'supplier-fulfillment', prompt: 'inside a massive modern ecommerce fulfillment center in USA, robots moving packages, high tech conveyor belts, bright clean industrial lighting, busy workers in blue vests, 8k photorealistic' },
  
  // Tools Grid
  { name: 'tools-ad-library', prompt: 'grid of colorful social media ad thumbnails, facebook ads interface, clean ui' },
  { name: 'tools-product-library', prompt: 'ecommerce product list interface with sparkline sales charts, clean tables, blue accents' },
  { name: 'tools-portfolio', prompt: 'grid of curated product cards with price tags, minimalist design, white background' },
  { name: 'tools-competitor', prompt: 'search bar interface with dropdown filters and store results list, clean data visualization' },
  { name: 'tools-magic-ai', prompt: 'artificial intelligence brain network visualization, connecting nodes, blue and white, tech abstract' },
  { name: 'tools-chrome-extension', prompt: 'browser extension popup window showing product analytics graph, floating over a webpage' },
  
  // Feature Rows
  { name: 'featurerows-tiktok-ad', prompt: 'tiktok style product video thumbnail, engaging hook text overlay, bright colors' },
  
  // Comprehensive Features
  { name: 'comprehensive-products', prompt: 'grid of trendy winning ecommerce products, smartwatches, beauty products, gadgets, high quality commercial photography, white background, soft lighting' },
  { name: 'comprehensive-model', prompt: 'fashion model wearing streetwear, urban setting, cinematic lighting, photorealistic portrait, 8k' },
  { name: 'comprehensive-academy', prompt: 'abstract educational 3d icons, books, graduation cap, light bulb, floating in dark space, neon blue light, cinematic' },
  
  // Blue CTA
  { name: 'cta-dashboard', prompt: 'dashboard view of ecommerce sales skyrocketing on a laptop screen, celebratory confetti, dark blue theme' },
  
  // Perks
  { name: 'perks-map', prompt: 'minimalist map illustration with route connections, line art style, blue and grey' },
  { name: 'perks-calendar', prompt: 'minimalist calendar interface with notification bubbles, clean ui vector style' },
  { name: 'perks-receipt', prompt: 'minimalist receipt or bill illustration being stamped paid, clean vector art style' },
  
  // Blog
  { name: 'blog-tiktok', prompt: 'tiktok logo on a smartphone screen in a modern office setting, depth of field' },
  { name: 'blog-electronics', prompt: 'flat lay of expensive looking consumer electronics and accessories, clean background' },
  { name: 'blog-strategy', prompt: 'concept art of ecommerce strategy, growing charts, coins, blue theme' },
  
  // Testimonials
  { name: 'testimonial-sarah', prompt: 'portrait of a successful young female entrepreneur, friendly smile, professional casual attire, bright modern home office background, high quality headshot' },
  { name: 'testimonial-marcus', prompt: 'portrait of a confident tech entrepreneur man, 30s, glasses, smart casual, modern tech startup office background, cinematic lighting' },
  { name: 'testimonial-elena', prompt: 'portrait of a creative fashion business owner woman, artistic vibe, warm lighting, boutique studio background, professional photography' },
  { name: 'testimonial-david', prompt: 'portrait of a fit male entrepreneur, outdoor lifestyle setting, confident, natural lighting, high resolution headshot' },
  
  // Competitor Intelligence
  { name: 'competitor-spy', prompt: 'futuristic spy software interface for ecommerce, dark mode dashboard, glowing red and green metrics, world map with data connections, matrix style visuals, high tech' },
  
  // Workflow
  { name: 'workflow-trench-coat', prompt: 'High end commercial photography of a stylish beige trench coat hanging on a minimal rack, bright white studio lighting, 4k, neutral background' },
  { name: 'workflow-model', prompt: 'Photorealistic portrait of a young diverse fashion model looking confident, bright daylight studio, white background, 8k, extremely detailed skin texture' },
  { name: 'workflow-studio', prompt: 'Wide shot of a professional photography studio with lights and cameras, bright atmosphere, behind the scenes, cinematic, white walls' },
  { name: 'workflow-campaign', prompt: 'Collage of 4 fashion photos of the same model in different outfits and poses, editorial fashion magazine style, high quality, white borders' },
  
  // Page.tsx world map
  { name: 'world-map', prompt: 'minimalist clean world map illustration, light grey on white background, subtle blue dots for active users' },
];

async function generateImage(name, prompt) {
  try {
    console.log(`Generating: ${name}...`);
    
    const enhancedPrompt = `${prompt}, clean UI interface, white background, high resolution, minimalist, dribbble style, no text glitches, vector style graphics`;
    
    const response = await ai.models.generateContent({
      model: 'gemini-2.5-flash-image',
      contents: {
        parts: [{ text: enhancedPrompt }]
      }
    });

    let imageData = null;
    if (response.candidates?.[0]?.content?.parts) {
      for (const part of response.candidates[0].content.parts) {
        if (part.inlineData) {
          imageData = part.inlineData.data;
          break;
        }
      }
    }

    if (!imageData) {
      console.error(`Failed to generate image for ${name}`);
      return false;
    }

    const filePath = join(outputDir, `${name}.png`);
    const buffer = Buffer.from(imageData, 'base64');
    writeFileSync(filePath, buffer);
    
    console.log(`✓ Saved: ${name}.png`);
    return true;
  } catch (error) {
    console.error(`Error generating ${name}:`, error.message);
    return false;
  }
}

async function generateAll() {
  console.log(`Generating ${imagePrompts.length} images...`);
  console.log(`Output directory: ${outputDir}\n`);
  
  let success = 0;
  let failed = 0;
  
  for (let i = 0; i < imagePrompts.length; i++) {
    const { name, prompt } = imagePrompts[i];
    const result = await generateImage(name, prompt);
    
    if (result) {
      success++;
    } else {
      failed++;
    }
    
    // Rate limiting - wait 2 seconds between requests
    if (i < imagePrompts.length - 1) {
      await new Promise(resolve => setTimeout(resolve, 2000));
    }
  }
  
  console.log(`\n✓ Generated ${success} images`);
  if (failed > 0) {
    console.log(`✗ Failed to generate ${failed} images`);
  }
  console.log(`\nImages saved to: ${outputDir}`);
}

generateAll().catch(console.error);

